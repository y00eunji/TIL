# ì¸ì¦ ë°©ì‹

- ì¿ í‚¤
- ì„¸ì…˜
- í† í°

[[WEB] ğŸ“š JWT í† í° ì¸ì¦ ì´ë€? - ğŸ’¯ ì´í•´í•˜ê¸° ì‰½ê²Œ ì •ë¦¬](https://inpa.tistory.com/entry/WEB-%F0%9F%93%9A-JWTjson-web-token-%EB%9E%80-%F0%9F%92%AF-%EC%A0%95%EB%A6%AC)

# JWT (Json Web Token)

ìœ ì €ë¥¼ ì¸ì¦í•˜ê³  ì‹ë³„í•˜ê¸° ìœ„í•œ **í† í°**ê¸°ë°˜ ì¸ì¦ì´ë‹¤. 

í† í°ì€ ì„¸ì…˜ê³¼ ë‹¬ë¦¬ ì„œë²„ê°€ ì•„ë‹Œ `í´ë¼ì´ì–¸íŠ¸`ì— ì €ì¥ë˜ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ë‚˜ ìŠ¤í† ë¦¬ì§€ ë“±ì„ í†µí•´ ì„¸ì…˜ì„ ê´€ë¦¬í–ˆë˜ ì„œë²„ì˜ ë¶€ë‹´ì„ ëœ ìˆ˜ ìˆìŒ.   

í† í° ìì²´ì— ì‚¬ìš©ìì˜ ê¶Œí•œ ì •ë³´ë‚˜ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì •ë³´ê°€ í¬í•¨ëœë‹¤. 

JWTëŠ” JSONë°ì´í„°ë¥¼ ì¸ì½”ë”©í•˜ì—¬ ì§ë ¬í™”í•œ ê²ƒì´ í¬í•¨ë˜ë©° í† í° ë‚´ë¶€ì—ëŠ” ìœ„ë³€ì¡° ë°©ì§€ë¥¼ ìœ„í•´ ê°œì¸í‚¤ë¥¼ í†µí•œ ì „ìì„œëª…ì´ ìˆìŒ. ë”°ë¼ì„œ ì‚¬ìš©ìê°€ JWTë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ë©´ ì„œë²„ëŠ” ì„œëª…ì„ ê²€ì¦í•˜ëŠ” ê³¼ì •ì„ ê±°ì¹˜ê²Œë˜ë©° ê²€ì¦ì´ ì™„ë£Œë˜ë©´ ìš”ì²­í•œ ì‘ë‹µì„ ëŒë ¤ì¤€ë‹¤. 

ì§„í–‰ ìˆœì„œ

1. í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©ìê°€ ì•„ì´ë””, íŒ¨ìŠ¤ì›Œë“œë¥¼ í†µí•´ ì›¹ ì„œë¹„ìŠ¤ ì¸ì¦
2. ì„œë²„ì—ì„œ ì„œëª…ëœ JWTë¥¼ ìƒì„±í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µìœ¼ë¡œ ëŒë ¤ì£¼ê¸°
3. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ë°ì´í„°ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ìš”êµ¬í•  ë•Œ JWTë¥¼ HTTP Header ì— ì²¨ë¶€
4. ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì˜¨ JWTë¥¼ ê²€ì¦ 

### êµ¬ì¡°

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80742339-7308-4424-8cef-09907cb9c671/Untitled.png)

JWTëŠ” Header, Payload, Signatureë¡œ êµ¬ì„±ë¨

Header : ì‚¬ìš©í•  íƒ€ì…ê³¼ í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ ì¢…ë¥˜

Payload : ì„œë²„ì—ì„œ ì²¨ë¶€í•œ ì‚¬ìš©ì ê¶Œí•œ ì •ë³´ì™€ ë°ì´í„°

Signature : Header,Payloadë¥¼ ì¸ì½”ë“œ í•œ ì´í›„ Headerì— ëª…ì‹œëœ í•´ì‹œí•¨ìˆ˜ë¥¼ ì ìš©í•˜ê³ , ê°œì¸í‚¤ë¡œ ì„œëª…í•œ ì „ìì„œëª…ì´ ë‹´ê²¨ìˆìŒ

### ì¸ì¦ ê³¼ì •

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7d362402-e300-4b95-9945-73c54b219ad6/Untitled.png)

1. ì‚¬ìš©ìê°€ ID, PWë¥¼ ì…ë ¥í•˜ì—¬ ì„œë²„ì— ë¡œê·¸ì¸ ì¸ì¦ì„ ìš”ì²­í•œë‹¤.
2. ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì¸ì¦ ìš”ì²­ì„ ë°›ìœ¼ë©´, Header, PayLoad, Signatureë¥¼ ì •ì˜í•œë‹¤.Hedaer, PayLoad, Signatureë¥¼ ê°ê° Base64ë¡œ í•œ ë²ˆ ë” ì•”í˜¸í™”í•˜ì—¬ JWTë¥¼ ìƒì„±í•˜ê³  ì´ë¥¼ ì¿ í‚¤ì— ë‹´ì•„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°œê¸‰í•œë‹¤.
3. í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë²„ë¡œë¶€í„° ë°›ì€ JWTë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œë‹¤. (ì¿ í‚¤ë‚˜ ë‹¤ë¥¸ ê³³ì— ì €ì¥í•  ìˆ˜ë„ ìˆìŒ)APIë¥¼ ì„œë²„ì— ìš”ì²­í• ë•ŒÂ **Authorization headerì— Access Tokenì„ ë‹´ì•„**ì„œ ë³´ë‚¸ë‹¤.
4. ì„œë²„ê°€ í•  ì¼ì€ í´ë¼ì´ì–¸íŠ¸ê°€ Headerì— ë‹´ì•„ì„œ ë³´ë‚¸ JWTê°€ ë‚´ ì„œë²„ì—ì„œ ë°œí–‰í•œ í† í°ì¸ì§€ ì¼ì¹˜ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì—¬ ì¼ì¹˜í•œë‹¤ë©´ ì¸ì¦ì„ í†µê³¼ì‹œì¼œì£¼ê³  ì•„ë‹ˆë¼ë©´ í†µê³¼ì‹œí‚¤ì§€ ì•Šìœ¼ë©´ ëœë‹¤.ì¸ì¦ì´ í†µê³¼ë˜ì—ˆìœ¼ë¯€ë¡œ í˜ì´ë¡œë“œì— ë“¤ì–´ìˆëŠ” ìœ ì €ì˜ ì •ë³´ë“¤ì„ selectí•´ì„œ í´ë¼ì´ì–¸íŠ¸ì— ëŒë ¤ì¤€ë‹¤.
5. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ìš”ì²­ì„ í–ˆëŠ”ë°, ë§Œì¼ ì•¡ì„¸ìŠ¤ í† í°ì˜ ì‹œê°„ì´ ë§Œë£Œë˜ë©´ í´ë¼ì´ì–¸íŠ¸ëŠ” ë¦¬í”„ë˜ì‹œ í† í°ì„ ì´ìš©í•´ì„œ
6. ì„œë²„ë¡œë¶€í„° ìƒˆë¡œìš´ ì—‘ì„¸ìŠ¤ í† í°ì„ ë°œê¸‰ ë°›ëŠ”ë‹¤.

### í† í° ì¸ì¦ ì‹ ë¢°ì„±ì„ ê°€ì§€ëŠ” ì´ìœ 

ìœ ì € JWT: A(Header) + B(Payload) + C(Signature) ì¼ ë•ŒÂ (ë§Œì¼ ì„ì˜ì˜ ìœ ì €ê°€ Bë¥¼ ìˆ˜ì •í–ˆë‹¤ê³  í•˜ë©´Â **B'**ë¡œ í‘œì‹œí•œë‹¤.)

1. ë‹¤ë¥¸ ìœ ì €ê°€ Bë¥¼ ì„ì˜ë¡œ ìˆ˜ì • -> ìœ ì € JWT: A +Â B'Â + C
2. ìˆ˜ì •í•œ í† í°ì„ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ë©´ ì„œë²„ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ì‹œí–‰
    - ìœ ì € JWT: A +Â B'Â + C
    - ì„œë²„ì—ì„œ ê²€ì¦ í›„ ìƒì„±í•œ JWT: A +Â B'Â + C' => (signature) ë¶ˆì¼ì¹˜
3. ëŒ€ì¡° ê²°ê³¼ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ ìœ ì €ì˜ ì •ë³´ê°€ ì„ì˜ë¡œÂ ë˜ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    
    **ì¡°ì‘ë˜ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆìŒ** 
    

## expressì—ì„œ JWT ì‚¬ìš©í•˜ê¸°

```jsx
// ì„œëª…
jwt.sign(payload, secertOnPrivateKey)

// ê²€ì¦
jwt.verify(token,secertPublic)

//Decode
jet.decode(token)
```

```jsx
const jwt = require('jsonwebtoken');

const name = 'charles' // payload
const secretKey = 'secret' // ë¹„ë°€í‚¤

// ì„œëª…
const token = jwt.sign({ name }, secretKey);
console.log(token);
// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiY2hhcmxlcyIsIml
// hdCI6MTY1MzA0NTU1OH0.BYEwnvRPSyIEN6wDQlWhtL1MzA0NTU1OH0.BYEwnvRP
// SyIEN6wDQlWhtLAFdd8BT274uPW8ffeRohs

// ê²€ì¦
const verify_token = jwt.verify(token, secretKey)
console.log(verify_token);
// { name: 'charles', iat: 1653045558 }

// Decode
console.log(jwt.decode(token))
// { name: 'charles', iat: 1653045558 }
```

iat : í† í° ë°œê¸‰ ì‹œê°„
